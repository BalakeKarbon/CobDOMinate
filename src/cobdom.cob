000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. COBDOM.
000300 ENVIRONMENT DIVISION.
000400 CONFIGURATION SECTION.
000500 SOURCE-COMPUTER. UNIX-LINUX.
000600 OBJECT-COMPUTER. WASM.
000700 INPUT-OUTPUT SECTION.
000800 FILE-CONTROL.
000900 DATA DIVISION.
001000 FILE SECTION.
001100 WORKING-STORAGE SECTION.
001200 COPY './data/js.cpy'.
001300 LINKAGE SECTION.
001400 01 LS-VERSION PIC 99V99.
001500 01 LS-ELEMENT-VARIABLE PIC X(128).
001600 01 LS-ELEMENT-TYPE PIC X(128).
001700 01 LS-PARENT PIC X(128).
001800 PROCEDURE DIVISION.
001900 COBDOM-VERSION SECTION.
002000 ENTRY 'COBDOM-VERSION' USING BY REFERENCE LS-VERSION.
002100*I think by reference is redundant here.
002200   MOVE .01 TO LS-VERSION.
002300*  CALL 'emscripten_run_script' USING BY CONTENT WS-JS-TEST.
002400*  MOVE FUNCTION TRIM('div', TRAILING) TO WS-ELEMENT-TYPE.
002500*  DISPLAY WS-ELEMENT-TYPE '.'.
002600   GOBACK.
002700 COBDOM-CREATE-ELEMENT SECTION.
002800 ENTRY 'COBDOM-CREATE-ELEMENT' USING BY 
002900   REFERENCE LS-ELEMENT-VARIABLE, 
003000   LS-ELEMENT-TYPE.
003100   STRING 
003200     LS-ELEMENT-VARIABLE
003300     PART-A OF CREATE-ELEMENT OF WS-JS-COMMANDS
003400     LS-ELEMENT-TYPE
003500     PART-B OF CREATE-ELEMENT OF WS-JS-COMMANDS DELIMITED BY SPACE
003600     WS-NULL-BYTE DELIMITED BY SIZE
003700*The null byte is needed because were passing C strings to
003800*emscripten's API.
003900   INTO WS-JS-COMMAND END-STRING.
004000   CALL 'emscripten_run_script' USING BY REFERENCE WS-JS-COMMAND.
004100   GOBACK.
004200 COBDOM-APPEND-CHILD SECTION.
004300 ENTRY 'COBDOM-APPEND-CHILD' USING BY REFERENCE
004400   LS-ELEMENT-VARIABLE, LS-PARENT.
004500   STRING
004600     LS-PARENT
004700     PART-A OF APPEND-CHILD OF WS-JS-COMMANDS
004800     LS-ELEMENT-VARIABLE
004900     PART-B OF APPEND-CHILD OF WS-JS-COMMANDS DELIMITED BY SPACE
005000     WS-NULL-BYTE DELIMITED BY SIZE
005100   INTO WS-JS-COMMAND END-STRING.
005200   CALL 'emscripten_run_script' USING BY REFERENCE WS-JS-COMMAND.
005300   GOBACK.
005400*COBDOM-INNER-HTML SECTION.
005500*ENTRY 'COBDOM-INNER-HTML' USING
005600*So here this gets crazy, since we are using eval, we can return
005700*the variable name, or we could store the objects in a structure
005800*and return its key/index, or we could create and add it relying
005900*only on the id.
