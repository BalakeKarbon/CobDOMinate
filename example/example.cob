000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. EXAMPLESITE.
000300 ENVIRONMENT DIVISION.
000400 CONFIGURATION SECTION.
000500 SOURCE-COMPUTER. UNIX-LINUX.
000600 OBJECT-COMPUTER. WASM.
000700 INPUT-OUTPUT SECTION.
000800 FILE-CONTROL.
000900 DATA DIVISION.
001000 FILE SECTION.
001100 WORKING-STORAGE SECTION.
001200 01 WS-CLASS-BUTTON PIC X(11) VALUE 'buttonClass'.
001300 01 WS-SPAN PIC X(4) VALUE 'span'.
001400 01 WS-DIV PIC X(3) VALUE 'div'.
001500 01 WS-CLICK PIC X(5) VALUE 'click'.
001600 01 WS-TAB-1.
001700   05 VAR PIC X(4) VALUE 'tab1'.
001800   05 NB PIC X VALUE X"00".
001900*Note when using grouping that will be passed to cobdom we must
002000*put null bytes between sections as COBOL stores this data
002100*contiguous in memory.
002200   05 LAB PIC X(5) VALUE 'Tab 1'.
002300   05 NB PIC X VALUE X"00".
002400   05 FUNC PIC X(4) VALUE 'TAB1'.
002500   05 NB PIC X VALUE X"00".
002600   05 CONT PIC X(256).
002700   05 NB PIC X VALUE X"00".
002800 01 WS-TAB-2.
002900   05 VAR PIC X(4) VALUE 'tab2'.
003000   05 NB PIC X VALUE X"00".
003100   05 LAB PIC X(5) VALUE 'Tab 2'.
003200   05 NB PIC X VALUE X"00".
003300   05 FUNC PIC X(4) VALUE 'TAB2'.
003400   05 NB PIC X VALUE X"00".
003500   05 CONT PIC X(256).
003600   05 NB PIC X VALUE X"00".
003700 01 WS-TAB-3.
003800   05 VAR PIC X(4) VALUE 'tab3'.
003900   05 NB PIC X VALUE X"00".
004000   05 LAB PIC X(5) VALUE 'Tab 3'.
004100   05 NB PIC X VALUE X"00".
004200   05 FUNC PIC X(4) VALUE 'TAB3'.
004300   05 NB PIC X VALUE X"00".
004400   05 CONT PIC X(256).
004500   05 NB PIC X VALUE X"00".
004600 01 WS-TAB-DIV.
004700   05 VAR PIC X(6) VALUE 'tabDiv'.
004800   05 NB PIC X VALUE X"00".
004900 01 WS-CONTENT-DIV.
005000   05 VAR PIC X(10) VALUE 'contentDiv'.
005100   05 NB PIC X VALUE X"00".
005200 01 WS-DOCBOD PIC X(4) VALUE 'body'.
005300 01 WS-NULL-BYTE PIC X(1) VALUE X'00'.
005400 01 WS-RETURN PIC S9.
005500*01 WS-BLOB PIC X(10000).
005600 LINKAGE SECTION.
005700 01 LS-BLOB PIC X(10000).
005800 01 LS-BLOB-SIZE PIC 9(10).
005900 PROCEDURE DIVISION.
006000 EXAMPLE SECTION.
006100 ENTRY 'EXAMPLE'.
006200   CALL 'LAYOUT'.
006300   CALL 'cobdom_fetch' USING 'FETCHCALLBACK',
006400     '/example/example.cob', 'GET', '' RETURNING WS-RETURN.
006500   GOBACK.
006600 FETCHCALLBACK SECTION.
006700*Note functions must not contain dashes in the name (-)
006800 ENTRY 'FETCHCALLBACK' USING BY REFERENCE LS-BLOB-SIZE,LS-BLOB.
006900*  DISPLAY LS-BLOB-SIZE.
007000   DISPLAY LS-BLOB(1:LS-BLOB-SIZE).
007100   GOBACK.
007200 LAYOUT SECTION.
007300 ENTRY 'LAYOUT'.
007400   CALL 'cobdom_create_element' USING BY REFERENCE
007500     VAR OF WS-TAB-1, WS-SPAN RETURNING WS-RETURN.
007600   CALL 'cobdom_set_class' USING BY REFERENCE
007700     VAR OF WS-TAB-1, WS-CLASS-BUTTON RETURNING WS-RETURN.
007800   CALL 'cobdom_inner_html' USING BY REFERENCE
007900     VAR OF WS-TAB-1, LAB OF WS-TAB-1 RETURNING WS-RETURN.
008000   CALL 'cobdom_create_element' USING BY REFERENCE
008100     VAR OF WS-TAB-2, WS-SPAN RETURNING WS-RETURN.
008200   CALL 'cobdom_set_class' USING BY REFERENCE
008300     VAR OF WS-TAB-2, WS-CLASS-BUTTON RETURNING WS-RETURN.
008400   CALL 'cobdom_inner_html' USING BY REFERENCE
008500     VAR OF WS-TAB-2,LAB OF WS-TAB-2 RETURNING WS-RETURN.
008600   CALL 'cobdom_create_element' USING BY REFERENCE
008700     VAR OF WS-TAB-3, WS-SPAN RETURNING WS-RETURN.
008800   CALL 'cobdom_set_class' USING BY REFERENCE
008900     VAR OF WS-TAB-3, WS-CLASS-BUTTON RETURNING WS-RETURN.
009000   CALL 'cobdom_inner_html' USING BY REFERENCE
009100     VAR OF WS-TAB-3, LAB OF WS-TAB-3 RETURNING WS-RETURN.
009200   CALL 'cobdom_create_element' USING BY REFERENCE
009300     VAR OF WS-TAB-DIV, WS-DIV RETURNING WS-RETURN.
009400   CALL 'cobdom_append_child' USING BY REFERENCE VAR OF WS-TAB-1,
009500     VAR OF WS-TAB-DIV RETURNING WS-RETURN.
009600   CALL 'cobdom_append_child' USING BY REFERENCE VAR OF WS-TAB-2,
009700     VAR OF WS-TAB-DIV RETURNING WS-RETURN.
009800   CALL 'cobdom_append_child' USING BY REFERENCE VAR OF WS-TAB-3,
009900     VAR OF WS-TAB-DIV RETURNING WS-RETURN.
010000   CALL 'cobdom_append_child' USING BY REFERENCE 
010100     VAR OF WS-TAB-DIV, WS-DOCBOD RETURNING WS-RETURN.
010200   CALL 'cobdom_add_event_listener' USING BY REFERENCE
010300     VAR OF WS-TAB-1, WS-CLICK, FUNC OF WS-TAB-1
010400     RETURNING WS-RETURN.
010500   CALL 'cobdom_add_event_listener' USING BY REFERENCE
010600     VAR OF WS-TAB-2, WS-CLICK, FUNC OF WS-TAB-2
010700     RETURNING WS-RETURN.
010800   CALL 'cobdom_add_event_listener' USING BY REFERENCE
010900     VAR OF WS-TAB-3, WS-CLICK, FUNC OF WS-TAB-3
011000     RETURNING WS-RETURN.
011100   CALL 'cobdom_class_style' USING BY REFERENCE
011200     WS-CLASS-BUTTON, 'display', 'inline-block' 
011300     RETURNING WS-RETURN.
011400   CALL 'cobdom_class_style' USING BY REFERENCE
011500     WS-CLASS-BUTTON, 'padding', '2rem' 
011600     RETURNING WS-RETURN.
011700   CALL 'cobdom_class_style' USING BY REFERENCE
011800     WS-CLASS-BUTTON, 'backgroundColor', '#006600' 
011900     RETURNING WS-RETURN.
012000   CALL 'cobdom_create_element' USING BY REFERENCE 
012100     VAR OF WS-CONTENT-DIV, WS-DIV RETURNING WS-RETURN.
012200   CALL 'cobdom_append_child' USING BY REFERENCE
012300     VAR OF WS-CONTENT-DIV, WS-DOCBOD RETURNING WS-RETURN.
012400   MOVE 'Welcome to tab 1!' TO CONT OF WS-TAB-1.
012500   MOVE 'Welcome to tab 2!' TO CONT OF WS-TAB-2.
012600   MOVE 'Welcome to tab 3!' TO CONT OF WS-TAB-3.
012700   CALL 'cobdom_inner_html' USING BY REFERENCE
012800     VAR OF WS-CONTENT-DIV, CONT OF WS-TAB-1 RETURNING WS-RETURN.
012900   CALL 'cobdom_style' USING BY REFERENCE
013000     VAR OF WS-TAB-1, 'backgroundColor', '#00ff00' 
013100     RETURNING WS-RETURN.
013200   GOBACK. 
013300 TAB1 SECTION.
013400 ENTRY 'TAB1'.
013500   CALL 'cobdom_class_style' USING BY REFERENCE
013600     WS-CLASS-BUTTON, 'backgroundColor', '#006600' 
013700     RETURNING WS-RETURN.
013800   CALL 'cobdom_style' USING BY REFERENCE
013900     VAR OF WS-TAB-1, 'backgroundColor', '#00ff00' 
014000     RETURNING WS-RETURN.
014100   CALL 'cobdom_inner_html' USING BY REFERENCE
014200     VAR OF WS-CONTENT-DIV, CONT OF WS-TAB-1 RETURNING WS-RETURN.
014300   GOBACK.
014400 TAB2 SECTION.
014500 ENTRY 'TAB2'.
014600   CALL 'cobdom_class_style' USING BY REFERENCE
014700     WS-CLASS-BUTTON, 'backgroundColor', '#006600' 
014800     RETURNING WS-RETURN.
014900   CALL 'cobdom_style' USING BY REFERENCE
015000     VAR OF WS-TAB-2, 'backgroundColor', '#00ff00' 
015100     RETURNING WS-RETURN.
015200   CALL 'cobdom_inner_html' USING BY REFERENCE
015300     VAR OF WS-CONTENT-DIV, CONT OF WS-TAB-2 RETURNING WS-RETURN.
015400   GOBACK.
015500 TAB3 SECTION.
015600 ENTRY 'TAB3'.
015700   CALL 'cobdom_class_style' USING BY REFERENCE
015800     WS-CLASS-BUTTON, 'backgroundColor', '#006600' 
015900     RETURNING WS-RETURN.
016000   CALL 'cobdom_style' USING BY REFERENCE
016100     VAR OF WS-TAB-3, 'backgroundColor', '#00ff00' 
016200     RETURNING WS-RETURN.
016300   CALL 'cobdom_inner_html' USING BY REFERENCE
016400     VAR OF WS-CONTENT-DIV, CONT OF WS-TAB-3 RETURNING WS-RETURN.
016500   GOBACK.
